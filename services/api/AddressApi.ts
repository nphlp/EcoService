import { Prisma } from "@prisma/client";
import { GetResult, InternalArgs, PrismaClientOptions } from "@prisma/client/runtime/library";
import {
    AddressCountCached,
    AddressFindFirstCached,
    AddressFindManyCached,
    AddressFindUniqueCached,
} from "@services/cached";
import { ResponseFormat, parseAndDecodeParams } from "@utils/FetchConfig";
import { NextRequest, NextResponse } from "next/server";

/**
 * # Address Api Services
 *
 * This file:
 * - is generated by the command `pnpm run generate:all`
 * - that executes the script: `scripts/generator.ts`
 * - which uses `template/services/api/{{model}}Api.hbs` as base template
 * - to generate api function files for every models available in the `prisma/client/index.d.ts`.
 *
 * > **Warning**: Do not edit this file directly. Your changes will be lost the next time the code is generated.
 */

// ========== Types ========== //

// Find First
type AddressFindFirstProps<T extends Prisma.AddressFindFirstArgs> = Prisma.SelectSubset<T, Prisma.AddressFindFirstArgs>;
type AddressFindFirstResponse<T extends Prisma.AddressFindFirstArgs> = GetResult<
    Prisma.$AddressPayload<InternalArgs>,
    T,
    "findFirst",
    PrismaClientOptions
>;

// Find Unique
type AddressFindUniqueProps<T extends Prisma.AddressFindUniqueArgs> = Prisma.SelectSubset<
    T,
    Prisma.AddressFindUniqueArgs
>;
type AddressFindUniqueResponse<T extends Prisma.AddressFindUniqueArgs> = GetResult<
    Prisma.$AddressPayload<InternalArgs>,
    T,
    "findUnique",
    PrismaClientOptions
>;

// Find Many
type AddressFindManyProps<T extends Prisma.AddressFindManyArgs> = Prisma.SelectSubset<T, Prisma.AddressFindManyArgs>;
type AddressFindManyResponse<T extends Prisma.AddressFindManyArgs> = GetResult<
    Prisma.$AddressPayload<InternalArgs>,
    T,
    "findMany",
    PrismaClientOptions
>;

// Count
type AddressCountProps<T extends Prisma.AddressCountArgs> = Prisma.SelectSubset<T, Prisma.AddressCountArgs>;
type AddressCountResponse<T extends Prisma.AddressCountArgs> =
    // eslint-disable-next-line
    T extends { select: any }
        ? T["select"] extends true
            ? number
            : Prisma.GetScalarType<T["select"], Prisma.AddressCountAggregateOutputType>
        : number;

// ========== Routes ========== //

type RouteResponse<T> = Promise<NextResponse<ResponseFormat<T>>>;

export type AddressRoutes<Input> = {
    /**
     * ## Address Find First (API)
     */
    "/address/findFirst": <T extends Prisma.AddressFindFirstArgs>() => {
        params: AddressFindFirstProps<T>;
        response: AddressFindFirstResponse<Input extends AddressFindFirstProps<T> ? Input : never>;
    };
    /**
     * ## Address Find Unique (API)
     */
    "/address/findUnique": <T extends Prisma.AddressFindUniqueArgs>() => {
        params: AddressFindUniqueProps<T>;
        response: AddressFindUniqueResponse<Input extends AddressFindUniqueProps<T> ? Input : never>;
    };
    /**
     * ## Address Find Many (API)
     */
    "/address/findMany": <T extends Prisma.AddressFindManyArgs>() => {
        params: AddressFindManyProps<T>;
        response: AddressFindManyResponse<Input extends AddressFindManyProps<T> ? Input : never>;
    };
    /**
     * ## Address Count (API)
     */
    "/address/count": <T extends Prisma.AddressCountArgs>() => {
        params: AddressCountProps<T>;
        response: AddressCountResponse<Input extends AddressCountProps<T> ? Input : never>;
    };
};

// ========== Services ========== //

export const AddressFindFirstApi = async <T extends Prisma.AddressFindFirstArgs>(
    request: NextRequest,
): RouteResponse<AddressFindFirstResponse<T>> => {
    try {
        const params: AddressFindFirstProps<T> = parseAndDecodeParams(request);
        const response: AddressFindFirstResponse<T> = await AddressFindFirstCached(params);
        return NextResponse.json({ data: response }, { status: 200 });
    } catch (error) {
        return NextResponse.json({ error: "AddressFindFirstApi -> " + (error as Error).message }, { status: 500 });
    }
};

export const AddressFindUniqueApi = async <T extends Prisma.AddressFindUniqueArgs>(
    request: NextRequest,
): RouteResponse<AddressFindUniqueResponse<T>> => {
    try {
        const params: AddressFindUniqueProps<T> = parseAndDecodeParams(request);
        const response: AddressFindUniqueResponse<T> = await AddressFindUniqueCached(params);
        return NextResponse.json({ data: response }, { status: 200 });
    } catch (error) {
        return NextResponse.json({ error: "AddressFindUniqueApi -> " + (error as Error).message }, { status: 500 });
    }
};

export const AddressFindManyApi = async <T extends Prisma.AddressFindManyArgs>(
    request: NextRequest,
): RouteResponse<AddressFindManyResponse<T>> => {
    try {
        const params: AddressFindManyProps<T> = parseAndDecodeParams(request);
        const response: AddressFindManyResponse<T> = await AddressFindManyCached(params);
        return NextResponse.json({ data: response }, { status: 200 });
    } catch (error) {
        return NextResponse.json({ error: "AddressFindManyApi -> " + (error as Error).message }, { status: 500 });
    }
};

export const AddressCountApi = async <T extends Prisma.AddressCountArgs>(
    request: NextRequest,
): RouteResponse<AddressCountResponse<T>> => {
    try {
        const params: AddressCountProps<T> = parseAndDecodeParams(request);
        const response: AddressCountResponse<T> = await AddressCountCached(params);
        return NextResponse.json({ data: response }, { status: 200 });
    } catch (error) {
        return NextResponse.json({ error: "AddressCountApi -> " + (error as Error).message }, { status: 500 });
    }
};
