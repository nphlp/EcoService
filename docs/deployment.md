# Deployment (Coolify process)

[Home](../README.md) > [Deployment](./deployment.md)

> You may be interested in the [CI/CD Workflow Docs](./ci-cd-workflows.md) as a complement to this documentation.

1. Create a `MySQL` environment:

Fill the form with the following information:

- Name: `Eco Service (database)` or any other name

- Normal User: `eco-service-user`

- Initial Database: `eco-service-db`

Save and start the environment

1. Go to the online terminal tab

Log in with the password generated by Coolify

```bash
mysql -u root -p <generated-root-password>
```

Add grant to the user on the database to allow Prisma to connect to the database.

```sql
GRANT ALL PRIVILEGES ON *.* TO 'eco-service-user'@'%';
GRANT ALL PRIVILEGES ON `eco-service-db`.* TO 'eco-service-user'@'%';
```

1. Create a new environment by linking the `Git` repository

You can use three methodes :

- Link public repository with HTTPS URL
- Link private repository with a Github App
- Link private repository with a Deploy Key

This action creates a `Node.js` environment automatically.

Fill the form with the following information:

- Name: `Eco Service (main)` or any other name

- Domain: `eco-service.domain.com`

- Install Command

```bash
pnpm install && pnpm prisma:generate && pnpm prisma:deploy
```

- Build Command

```bash
pnpm run build && pnpm install --prod
```

- Start Command

```bash
pnpm run start
```

Save the configuration, but don't start the environment.

1. Add environment variables in the environment variables tab

```env
# Node environment
NODE_ENV=development

# Base URL
NEXT_PUBLIC_BASE_URL=https://eco-service.domain.com

# Mysql root password (used in script/db.ts)
MYSQL_ROOT_PASSWORD=root

# Mysql URL from prisma
DATABASE_URL=mysql://eco-service-user: ******** @ ******** /eco-service-db

# Redis (not yet available)
# REDIS_URL=redis://localhost:6379
# REDIS_ARGS=--save 1 1

# Better Auth encryption key
BETTER_AUTH_SECRET=session-encryption-key

# Plunk (requires to create an account, please follow the docs)
PLUNK_API_KEY=plunk-private-key

# Stripe (requires to create an account, please follow the docs)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxxxx
STRIPE_SECRET_KEY=sk_test_pk_test_xxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxx
```

- Save variables and start the environment
